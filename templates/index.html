<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pneumonia Prediction</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <h1>Pneumonia Prediction</h1>
        <input type="file" class="image-upload" id="image-upload" accept="image/*">
        <canvas id="canvas" width="200" height="200" style="border:1px solid;"></canvas>
        <button onclick="predict()">Predict</button>
        <p id="result"></p>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const resultElement = document.getElementById('result');
        const imageUpload = document.getElementById('image-upload');

        imageUpload.addEventListener('change', (event) => {
            const file = event.target.files[0];
            const reader = new FileReader();

            reader.onload = (e) => {
                const img = new Image();
                img.src = e.target.result;
                img.onload = () => ctx.drawImage(img, 0, 0, 200, 200);
            };

            if (file) {
                reader.readAsDataURL(file);
            }
        });

        async function predict() {
            const imgData = canvas.toDataURL();
            const response = await fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                },
                body: 'img_data=' + encodeURIComponent(imgData)
            });

            const result = await response.json();
            if (result.pneumonia > result.normal) {
                resultElement.textContent = 'This person has pneumonia.' + result.pneumonia;
            } else {
                resultElement.textContent = 'This person does not have pneumonia.';
            }
        }
    </script>
</body>
</html>